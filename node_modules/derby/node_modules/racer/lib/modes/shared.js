// Generated by CoffeeScript 1.3.3
var createAdapter;

createAdapter = require('../adapters').createAdapter;

exports.createJournal = function(modeOptions) {
  var journal;
  return journal = createAdapter('journal', modeOptions.journal || {
    type: 'Memory'
  });
};

exports.createStartIdVerifier = function(getStartId) {
  return function(req, res, next) {
    var clientStartId;
    if (req.ignoreStartId) {
      return next();
    }
    clientStartId = req.startId;
    return getStartId(function(err, startId) {
      if (err) {
        return res.fail(err);
      }
      if (clientStartId && clientStartId !== startId) {
        return res.fail("clientStartId != startId (" + clientStartId + " != " + startId + ")");
      }
      return next();
    });
  };
};
